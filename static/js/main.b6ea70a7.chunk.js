(this.webpackJsonpportfolio=this.webpackJsonpportfolio||[]).push([[0],{29:function(t,e,a){},36:function(t,e,a){},56:function(t,e,a){},57:function(t,e,a){"use strict";a.r(e);var r=a(0),n=a(9),o=a.n(n),s=(a(29),a(3)),i=a(4),c=a.n(i),l=a(12),d=a(5),u=a(11),f=a(6),h=a.n(f),b=a(1),p=function(t){var e=t.series,a=t.labels,r={chart:{foreColor:"#fff"},stroke:{colors:["#161d20"]},colors:["#ED5565","#FFCE54","#48CFAD","#4FC1E9","#FC6E51","#5D9CEC"],dataLabels:{enabled:!1},plotOptions:{pie:{donut:{labels:{show:!0,name:{show:!0,fontSize:"20",fontWeight:"700"},value:{show:!0,fontSize:"16",fontFamily:"Microsoft JhengHei",fontWeight:"700",formatter:function(t){return"$"+parseFloat(parseFloat(t).toFixed(0))}},total:{show:!0,label:"Total",fontFamily:"Microsoft JhengHei",color:"#fff",fontWeight:"700",formatter:function(t){var e=t.globals.seriesTotals.reduce((function(t,e){return t+e}),0);return"$"+parseFloat(e.toFixed(0))}}}}}}};return Object(b.jsx)(h.a,{options:Object(u.a)({labels:a},r),series:e,type:"donut",height:"200px"})},j=(a(36),function(t){var e=t.headRow,a=t.dataRows,n=t.targetData,o=Object(r.useState)(0),s=Object(d.a)(o,2),i=s[0],c=s[1],l=function(t){0===i&&-1===t||5*(i+t)>=a.length||c(i+t)},u=function(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)};return Object(b.jsxs)("div",{className:"tableBlock",children:[Object(b.jsxs)("table",{children:[Object(b.jsx)("thead",{children:Object(b.jsx)("tr",{children:e.map((function(t){return Object(b.jsx)("th",{style:"\u640d\u76ca"===t?{cursor:"pointer"}:{},children:t},t)}))})}),Object(b.jsx)("tbody",{children:a.slice(5*i,5*i+5).map((function(t,e){return Object(b.jsx)("tr",{children:n.map((function(a){if("averageCost"===a){var r=u(t.totalCost/t.totalQuantity,2);return Object(b.jsxs)("td",{children:[" ",r," "]},r.toString()+"-"+e.toString()+"-"+Math.random().toFixed(3))}if("holdingPercent"===a)return Object(b.jsx)("td",{children:t[a]+"%"},t[a].toString()+"-"+e.toString()+"-"+Math.random().toFixed(3));if("totalProfit"===a||"profitPercent"===a){var n=t[a]<0?t[a].toFixed(2):"+"+t[a].toFixed(2);return"profitPercent"===a&&(n+="%"),Object(b.jsx)("td",{style:t[a]<0?{color:"#F15B46"}:{color:"#76c68f"},children:n},t[a].toString()+"-"+e.toString()+"-"+Math.random().toFixed(3))}return Object(b.jsx)("td",{children:"number"===typeof t[a]?u(t[a],2):t[a]},t[a].toString()+"-"+e.toString()+"-"+Math.random().toFixed(3))}))},e)}))})]}),Object(b.jsxs)("div",{className:"paging",children:[Object(b.jsx)("button",{className:"page",onClick:function(){return l(-1)},disabled:0===i?"disabled":"",children:"<"}),Object(b.jsx)("button",{className:"page",onClick:function(){return l(1)},disabled:5*(i+1)>=a.length?"disabled":"",children:">"})]})]})}),g=function(t){var e=t.title,a=t.data;return Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{className:"title",style:{fontSize:"15px"},children:e}),Object(b.jsx)("div",{className:"data",style:{fontSize:"35px"},children:a})]})},v=function(t){var e=t.series,a=t.labels,r={chart:{type:"bar",foreColor:"#fff"},yaxis:{labels:{formatter:function(t){return t+"%"}}},plotOptions:{bar:{colors:{ranges:[{from:Number.NEGATIVE_INFINITY,to:0,color:"#F15B46"},{from:0,to:Number.MAX_SAFE_INTEGER,color:"#76c68f"}]},columnWidth:"45%"}},dataLabels:{enabled:!1}};return Object(b.jsx)(h.a,{options:Object(u.a)({xaxis:{categories:a}},r),series:[{name:"Profit",data:e}],type:"bar",height:"240px"})},O=function(t){var e=t.data;return Object(b.jsx)(h.a,{options:{chart:{height:350,type:"area",foreColor:"#fff",zoom:{enabled:!1}},stroke:{curve:"straight"},xaxis:{type:"datetime"},yaxis:{labels:{formatter:function(t){return t.toFixed(1)}}},dataLabels:{enabled:!1}},series:[{name:"price",data:e}],type:"area",style:{color:"#000"},height:"300px"})},y=a(13),m=a(24),x=(a(37),a(23)),D=a.n(x),N=(a(56),function(){var t=Object(r.useState)({infoData:{totalCost:0,myAsset:0,ROI:0,totalProfit:0},enterprises:[],tradingHistory:[]}),e=Object(d.a)(t,2),a=e[0],n=e[1],o=Object(r.useState)({reqSend:!1,fileLoaded:!1}),i=Object(d.a)(o,2),u=i[0],f=i[1],h=Object(r.useState)(!1),x=Object(d.a)(h,2),N=x[0],S=x[1],F=Object(r.useState)([{x:new Date(16402698e5).toLocaleString(),y:100}]),P=Object(d.a)(F,2),w=P[0],k=P[1],C=Object(r.useState)({headRow:["\u4ee3\u865f","\u80a1\u6578","\u55ae\u4f4d\u6210\u672c","\u640d\u76ca","\u5360\u6bd4"],targetData:["symbol","totalQuantity","averageCost","totalProfit","holdingPercent"]}),I=Object(d.a)(C,2),M=I[0],E=I[1],R={headRow:["\u4ee3\u865f","\u4ea4\u6613\u6642\u9593","\u80a1\u6578","\u6210\u4ea4\u50f9","\u91d1\u984d"],targetData:["symbol","tradingDate","quantity","purchasePrice","totalCost"]};Object(r.useEffect)((function(){console.log("in useEffect"),document.title="Portfolio",u.fileLoaded&&V(0,7)}),[a]);var T=function(){var t=Object(l.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,z(["MSFT","SMH","QQQ","VOO"]);case 2:q([["SMH","300","2021/12/6","16:00 EST","-1.1499939","299.57","301.38","290.51","5105964","20211206","299.02","0.96984","","","",""],["MSFT","326.19","2021/12/6","16:00 EST","3.1799927","323.95","327.42","319.23","30032556","20211126","334.11","0.29929","","","",""],["MSFT","326.19","2021/12/6","16:00 EST","3.1799927","323.95","327.42","319.23","30032556","20211206","324.71","1.75542","","","",""],["VOO","421.82","2021/12/6","16:00 EST","4.98001","419.41","423.64","417","7124862","20211126","424.96","0.35298","","","",""],["VOO","421.82","2021/12/6","16:00 EST","4.98001","419.41","423.64","417","7124862","20211206","419.85","2.71527","","","",""],["QQQ","386.2","2021/12/6","16:00 EST","3.0700073","383.63","387.6","379.31","64706783","20211126","396.07","0.25248","","","",""],["QQQ","386.2","2021/12/6","16:00 EST","3.0700073","383.63","387.6","379.31","64706783","20211206","384.08","2.23912","","","",""]],{symbol:0,purchasePrice:10,quantity:11,tradingDate:9});case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Q=function(){var t=Object(l.a)(c.a.mark((function t(e){var a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(a=0;a<e[0].length;a++)e[0][a]=e[0][a].trim();if(!Y(e[0])){t.next=3;break}return t.delegateYield(c.a.mark((function t(){var a,r,n,o,s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(a={symbol:e[0].indexOf("Symbol"),purchasePrice:e[0].indexOf("Purchase Price"),quantity:e[0].indexOf("Quantity"),tradingDate:e[0].indexOf("Trade Date")},r=[],n=[],o=function(t){e[t][a.symbol]&&e[t][a.purchasePrice]&&e[t][a.quantity]&&e[t][a.tradingDate]&&(n.push(e[t]),r.find((function(r){return r===e[t][a.symbol].trim()}))||r.push(e[t][a.symbol].trim()))},s=1;s<e.length;s++)o(s);return t.next=7,z(r);case 7:q(n,a);case 8:case"end":return t.stop()}}),t)}))(),"t0",3);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),q=function(t,e){var a=L(t,e),r=a.infoData,o=a.enterprises,s=H(t,e);n({enterprises:o,tradingHistory:s,infoData:r})},L=function(t,e){var a,r=[],n=0,o=0,i=0,c={},l=JSON.parse(sessionStorage.getItem("symbols")),d=Object(s.a)(l);try{for(d.s();!(a=d.n()).done;){var u=a.value;c[u.symbol]=u.data[u.data.length-1]}}catch(E){d.e(E)}finally{d.f()}var f,h=function(t,e){for(var a=0;a<t.length;a++)if(t[a].symbol===e)return a;return!1},b=Object(s.a)(t);try{for(b.s();!(f=b.n()).done;){var p=f.value,j=p[e.symbol],g=c[j],v=parseFloat(p[e.tradingDate]),O=parseFloat(p[e.purchasePrice]),y=parseFloat(p[e.quantity]);n+=O*y,i+=g*y;var m=h(r,j);!1!==m?(r[m].tradingHistory.push({purchasePrice:O,quantity:y}),r[m].totalCost+=O*y,r[m].totalQuantity+=y):r.push({symbol:j,currentPrice:g,tradingDate:v,totalCost:O*y,totalQuantity:y,tradingHistory:[{purchasePrice:O,quantity:y}]})}}catch(E){b.e(E)}finally{b.f()}for(var x=0,D=r;x<D.length;x++){var N=D[x];N.holdingPercent=Math.round(N.currentPrice*N.totalQuantity/i*1e4)/100;var S,F=0,P=N.currentPrice,w=Object(s.a)(N.tradingHistory);try{for(w.s();!(S=w.n()).done;){var k=S.value;F+=(P-k.purchasePrice)*k.quantity}}catch(E){w.e(E)}finally{w.f()}N.totalProfit=F,o+=F}for(var C=0,I=r;C<I.length;C++){var M=I[C];M.profitPercent=Math.round(M.totalProfit/M.totalCost*1e4)/100}return r.sort((function(t,e){return e.holdingPercent-t.holdingPercent})),{infoData:{totalCost:n,myAsset:n+o,ROI:o/n,totalProfit:o},enterprises:r}},H=function(t,e){var a,r=[],n=Object(s.a)(t);try{for(n.s();!(a=n.n()).done;){var o=a.value,i=o[e.symbol],c=o[e.tradingDate],l=parseFloat(o[e.purchasePrice]),d=parseFloat(o[e.quantity]);c=c?c.slice(0,4)+"/"+c.slice(4,6)+"/"+c.slice(6,8):"NaN",r.push({symbol:i,tradingDate:c,quantity:d,purchasePrice:l,totalCost:l*d})}}catch(u){n.e(u)}finally{n.f()}return r.sort((function(t,e){if("NaN"===t.tradingDate&&"NaN"!==e.tradingDate)return 1;if("NaN"!==t.tradingDate&&"NaN"===e.tradingDate)return-1;var a=t.tradingDate.split("/"),r=e.tradingDate.split("/");return parseInt(a[0])>parseInt(r[0])?-1:parseInt(a[0])<parseInt(r[0])?1:parseInt(a[1])>parseInt(r[1])?-1:parseInt(a[1])<parseInt(r[1])?1:parseInt(a[2])>parseInt(r[2])?-1:parseInt(a[2])<parseInt(r[2])?1:void 0})),r},A=function(){var t,e=[],r=Object(s.a)(a.enterprises);try{for(r.s();!(t=r.n()).done;){var n=t.value;e.push(n.symbol)}}catch(o){r.e(o)}finally{r.f()}return e},B=function(){var t,e=[],r=Object(s.a)(a.enterprises);try{for(r.s();!(t=r.n()).done;){var n=t.value,o=(n.totalQuantity*n.currentPrice).toFixed(2);e.push(parseFloat(o))}}catch(i){r.e(i)}finally{r.f()}return e},J=function(){var t,e=[],r=Object(s.a)(a.enterprises);try{for(r.s();!(t=r.n()).done;){var n=t.value;e.push(Math.round(n.totalProfit/n.totalCost*1e4)/100)}}catch(o){r.e(o)}finally{r.f()}return e},z=function(){var t=Object(l.a)(c.a.mark((function t(e){var a,r,n,o,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a="",r=Object(s.a)(e);try{for(r.s();!(n=r.n()).done;)o=n.value,a+=o.trim()+","}catch(c){r.e(c)}finally{r.f()}return a=a.slice(0,a.length-1),i={method:"GET",url:"https://yfapi.net/v8/finance/spark",headers:{"x-api-key":"auNxCyh1Gf66HIXod3SN5aeAVI6JUB37Kd5iClYh"},params:{symbols:a,interval:"1d",range:"1y"}},f({reqSend:!0,fileLoaded:!1}),t.abrupt("return",D.a.request(i).then((function(t){var e=t.data;console.log("response",e);var a=[];for(var r in e)a.push({symbol:r,data:e[r].close,date:e[r].timestamp});sessionStorage.clear(),sessionStorage.setItem("symbols",JSON.stringify(a)),f({reqSend:!0,fileLoaded:!0})})).catch((function(t){console.log(t),y.b.error("\u8acb\u6c42\u8cc7\u6599\u6642\u767c\u751f\u932f\u8aa4.")})));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),V=function(t,e){var r=t+"-"+e+"-performance",n=sessionStorage.getItem(r);if(n)console.log("get search:",r),k(JSON.parse(n));else{n=[];var o=new Date;o.setMonth(o.getMonth()-t),o.setDate(o.getDate()-e);for(var i=Date.now(),c=function(t,e){var a=t.getFullYear(),r=t.getMonth(),n=t.getDate(),o=e.getFullYear(),s=e.getMonth(),i=e.getDate();return a<o||a===o&&r<s||a===o&&r===s&&n<i?1:a===o&&r===s&&n===i?0:-1},l=JSON.parse(sessionStorage.getItem("symbols")),d=o;d<=i;d.setDate(d.getDate()+1)){var u,f=0,h=[],b=Object(s.a)(l);try{for(b.s();!(u=b.n()).done;)for(var p=u.value,j=0;j<p.date.length;j++){if(j===p.date.length-1){h.push({symbol:p.symbol,price:p.data[j]});break}if(0===c(d,new Date(1e3*p.date[j]))){h.push({symbol:p.symbol,price:p.data[j]});break}if(-1===c(d,new Date(1e3*p.date[j]))&&1===c(d,new Date(1e3*p.date[j+1]))){h.push({symbol:p.symbol,price:p.data[j-1]});break}}}catch(y){b.e(y)}finally{b.f()}var g,v=Object(s.a)(a.tradingHistory);try{var O=function(){var t=g.value;if(-1===c(d,new Date(t.tradingDate))||0===c(d,new Date(t.tradingDate))){var e=h.find((function(e){return e.symbol===t.symbol}));f+=t.quantity*e.price}};for(v.s();!(g=v.n()).done;)O()}catch(y){v.e(y)}finally{v.f()}n.push({x:d.toLocaleDateString(),y:f})}sessionStorage.setItem(r,JSON.stringify(n)),k(n)}},Y=function(t){for(var e=0,a=["Symbol","Purchase Price","Quantity","Trade Date"];e<a.length;e++){var r=a[e];if(-1===t.indexOf(r)){S(!1);var n='csv\u6a94\u7f3a\u5c11 "'+r+'" \u6b04\u4f4d.';return y.b.error(n),!1}}return!0},G=function(t){var e=new FileReader;e.onload=function(){var t,a=e.result.split("\n"),r=[],n=Object(s.a)(a);try{for(n.s();!(t=n.n()).done;){var o=t.value;r.push(o.split(","))}}catch(i){n.e(i)}finally{n.f()}Q(r)},e.readAsBinaryString(t)},W=function(t){var e,a=t.target.parentNode.childNodes,r=Object(s.a)(a);try{for(r.s();!(e=r.n()).done;){e.value.classList.remove("focus")}}catch(n){r.e(n)}finally{r.f()}t.target.classList.add("focus")};return Object(b.jsxs)("div",{className:"App",style:u.fileLoaded?{}:{maxHeight:"100vh",overflow:"hidden",paddingLeft:"6px",paddingRight:"6px"},children:[Object(b.jsx)("h1",{children:"My Portfolio"}),Object(b.jsx)("div",{className:!u.fileLoaded&&u.reqSend?"load":"hide"}),Object(b.jsxs)("div",{className:u.reqSend?"hide":"",children:[Object(b.jsx)("div",{className:"drag-file-block",onDragEnter:function(t){t.stopPropagation(),t.preventDefault(),S(!0)},onDragOver:function(t){t.stopPropagation(),t.preventDefault()},onDragLeave:function(t){t.preventDefault(),t.stopPropagation(),S(!1)},onDrop:function(t){t.preventDefault(),t.stopPropagation();var e=t.dataTransfer.items[0].getAsFile();G(e)},style:N?{backgroundColor:"rgba(173, 216, 230, .5)"}:{backgroundColor:"inherit"},children:Object(b.jsxs)("div",{className:"dropInfo",children:[Object(b.jsx)("div",{className:"fileIcon",children:Object(b.jsx)(m.a,{size:30})}),Object(b.jsx)("div",{children:"\u5c07 csv \u6a94\u62d6\u66f3\u81f3\u6b64"})]})}),Object(b.jsxs)("label",{className:"input-label",children:[Object(b.jsx)("span",{children:"\ud83d\udcc1 \u4e0a\u50b3\u6a94\u6848"}),Object(b.jsx)("div",{style:{display:"none"},children:Object(b.jsx)("input",{type:"file",accept:".csv",onChange:function(t){var e=t.target.files[0];G(e),t.target.value=""}})})]}),Object(b.jsx)("label",{className:"input-label",onClick:T,children:Object(b.jsx)("span",{children:"\ud83d\udca1 \u4f7f\u7528\u7bc4\u4f8b"})})]}),Object(b.jsxs)("main",{className:u.fileLoaded?"":"hide",children:[Object(b.jsxs)("div",{className:"block-row",id:"info",children:[Object(b.jsx)(g,{data:parseFloat(a.infoData.totalCost.toFixed(2)),title:"\u6295\u5165\u91d1\u984d"}),Object(b.jsx)(g,{data:parseFloat(a.infoData.myAsset.toFixed(2)),title:"\u80a1\u7968\u5e02\u503c"}),Object(b.jsx)(g,{data:parseFloat((100*a.infoData.ROI).toFixed(2))+"%",title:"\u5831\u916c\u7387",highlight:!0}),Object(b.jsx)(g,{data:parseFloat(a.infoData.totalProfit)<0?parseFloat(parseFloat(a.infoData.totalProfit).toFixed(2)):"+"+parseFloat(parseFloat(a.infoData.totalProfit).toFixed(2)),title:"\u7e3d\u640d\u76ca"})]}),Object(b.jsx)("div",{className:"block-title res-title",children:Object(b.jsx)("h3",{children:"\u6301\u80a1\u72c0\u6cc1"})}),Object(b.jsxs)("div",{className:"block-row",children:[Object(b.jsx)("div",{className:"left chart",children:Object(b.jsx)(p,{series:0===B().length?[8e4,45e3,16e3]:B(),labels:0===A().length?["stock1","stock2","stock3"]:A()})}),Object(b.jsx)("div",{className:"right",onClick:function(t){"\u640d\u76ca"===t.target.textContent&&(M.targetData.includes("profitPercent")?E({headRow:M.headRow,targetData:["symbol","totalQuantity","averageCost","totalProfit","holdingPercent"]}):E({headRow:M.headRow,targetData:["symbol","totalQuantity","averageCost","profitPercent","holdingPercent"]}))},children:Object(b.jsx)(j,{headRow:M.headRow,dataRows:a.enterprises,targetData:M.targetData})})]}),Object(b.jsxs)("div",{className:"block-row",children:[Object(b.jsxs)("div",{className:"left chart",style:{color:"#000"},children:[Object(b.jsx)("div",{className:"block-title",children:Object(b.jsx)("h3",{children:"\u7e3e\u6548"})}),Object(b.jsx)(v,{series:0===J().length?[5,3,-10,10,7]:J(),labels:0===A().length?["stock1","stock2","stock3","stock4","stock5"]:A()})]}),Object(b.jsxs)("div",{className:"right",children:[Object(b.jsx)("div",{className:"block-title",children:Object(b.jsx)("h3",{children:"\u4ea4\u6613\u7d00\u9304"})}),Object(b.jsx)(j,{headRow:R.headRow,dataRows:a.tradingHistory,targetData:R.targetData})]})]}),Object(b.jsx)("div",{className:"block-title res-title",children:Object(b.jsx)("h3",{children:"\u80a1\u7968\u5e02\u503c\u8d70\u52e2"})}),Object(b.jsxs)("div",{children:[Object(b.jsxs)("div",{children:[Object(b.jsx)("button",{className:"focus timeButton",onClick:function(t){V(0,7),W(t)},children:"7\u5929"}),Object(b.jsx)("button",{className:"timeButton",onClick:function(t){V(1,0),W(t)},children:"1\u6708"}),Object(b.jsx)("button",{className:"timeButton",onClick:function(t){V(6,0),W(t)},children:"6\u6708"}),Object(b.jsx)("button",{className:"timeButton",onClick:function(t){V(12,0),W(t)},children:"1\u5e74"})]}),Object(b.jsx)(O,{data:w})]}),Object(b.jsx)("div",{className:"footer"})]}),Object(b.jsx)(y.a,{position:"top-right",autoClose:5e3,theme:"dark",hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0})]})});o.a.render(Object(b.jsx)(N,{}),document.getElementById("root"))}},[[57,1,2]]]);
//# sourceMappingURL=main.b6ea70a7.chunk.js.map